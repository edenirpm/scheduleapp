unit Controller.FrmCalendar;

interface

uses
 model.agendar,model.funcionario,model.marcacao,uworks;

Type
IController = interface
  ['{B028A05A-F069-44FB-9281-75B3264B24E5}']
  procedure ShowForm;
  function Agendar(ADate:TDate):IWork;
  function CreateAgendar:IController;
  function CriarFuncionariosFicticios:IController;
end;

TController = class (TInterfacedObject,IController,IWork)
 FAgenda:TAgendar;
 procedure ShowForm;
 function Agendar(ADate:TDate):IWork;
 function CreateAgendar:IController;
 function CriarFuncionariosFicticios:IController;
 function Execute:IWork;
end;

implementation

uses
  FMX.Forms,UfrmAgendaDiaFuncionario, System.SysUtils, FMX.Dialogs;

{ TController }

function TController.Agendar(ADate: TDate):IWork;
var
 Agendar:TAgendar;
 Funcionario:TFuncionario;
 Marcacao:TMarcacao;
begin
 Result:=Self;
 Agendar:=TAgendar.GetInstance;
// Showmessage(Agendar.Empresa.Nome);
 Agendar.DataSelecionada:=ADate;
end;

function TController.CreateAgendar: IController;
begin
Result:=self;
FAgenda:=TAgendar.GetInstance;
end;


function TController.CriarFuncionariosFicticios: IController;
var
 Funcionario1,Funcionario2:TFuncionario;

begin
  CreateAgendar;
 if FAgenda.Funcionarios.Count <=0 then
 begin
    try
     Funcionario1:=TFuncionario.create;
     Funcionario1.Cordialidade:='Sr.';
     Funcionario1.Nome:='Edenir P. Martins';
     Funcionario2:=TFuncionario.create;
     Funcionario2.Cordialidade:='Sra.';
     Funcionario2.Nome:='Carmen C. Balbino';
    finally
    FAgenda.Funcionarios.Add(Funcionario1);
    FAgenda.Funcionarios.Add(Funcionario2);
    end;
 end;

    //Fagenda.Funcionarios.Items[0].Agendamentos.Marcacoes.items[0].Servico.Nome:='Consulta';
   //FAgenda.Funcionarios.Items[0].Agendamentos.Marcacoes.items[0].Status:='Confirmado';
  //Fagenda.Funcionarios.Items[0].Agendamentos.Marcacoes.items[0].Cliente.Nome;
 //Fagenda.Funcionarios.Items[0].Agendamentos.Marcacoes.Items[0].Data:=now;
// Fagenda.Funcionarios.Items[0].Agendamentos.Marcacoes.Items[0].Horas.Add(ATtime);
end;

function TController.Execute: IWork;
begin

end;

procedure TController.ShowForm;
begin
  Application.CreateForm(TFrmAgendaDiaFuncionario, FrmAgendaDiaFuncionario);
  FrmAgendaDiaFuncionario.show;
end;


end.
